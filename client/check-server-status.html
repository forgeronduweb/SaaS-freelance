<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>V√©rification Serveur</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 50px auto; padding: 20px; }
        .btn { background: #ff6b35; color: white; padding: 12px 24px; border: none; border-radius: 6px; cursor: pointer; font-size: 16px; margin: 10px 5px; }
        .btn:hover { background: #e55a2b; }
        .result { margin: 20px 0; padding: 15px; border-radius: 6px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        .warning { background: #fff3cd; color: #856404; }
        .code { background: #f8f9fa; padding: 10px; border-radius: 4px; font-family: monospace; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>üîç Diagnostic Serveur Next.js</h1>
    
    <div class="info">
        <h3>Erreur d√©tect√©e: "Failed to fetch"</h3>
        <p>Cela signifie g√©n√©ralement que le serveur Next.js n'est pas d√©marr√© ou n'est pas accessible.</p>
    </div>
    
    <button class="btn" onclick="checkServer()">üîç V√©rifier le serveur</button>
    <button class="btn" onclick="checkAPIs()">üåê Tester les APIs</button>
    
    <div id="result"></div>
    
    <div class="warning">
        <h3>üìã Solutions possibles :</h3>
        
        <h4>1. D√©marrer le serveur de d√©veloppement :</h4>
        <div class="code">
            cd D:\Documents\PROGRAMMATION\Saas\freelance-plateform\client<br>
            npm run dev
        </div>
        
        <h4>2. V√©rifier le port :</h4>
        <p>Le serveur devrait √™tre accessible sur <strong>http://localhost:3000</strong></p>
        
        <h4>3. V√©rifier les d√©pendances :</h4>
        <div class="code">
            npm install
        </div>
        
        <h4>4. Red√©marrer compl√®tement :</h4>
        <div class="code">
            Ctrl+C (arr√™ter le serveur)<br>
            npm run dev (red√©marrer)
        </div>
    </div>
    
    <script>
        async function checkServer() {
            const result = document.getElementById('result');
            result.innerHTML = '<div class="info">‚è≥ V√©rification du serveur...</div>';
            
            const ports = [3000, 3001, 3002, 8080];
            let serverFound = false;
            
            for (const port of ports) {
                try {
                    const response = await fetch(`http://localhost:${port}`, {
                        method: 'GET',
                        mode: 'no-cors'
                    });
                    
                    result.innerHTML = `
                        <div class="success">
                            ‚úÖ <strong>Serveur trouv√© sur le port ${port}!</strong><br>
                            URL: <a href="http://localhost:${port}" target="_blank">http://localhost:${port}</a>
                        </div>
                    `;
                    serverFound = true;
                    break;
                } catch (error) {
                    console.log(`Port ${port} non accessible:`, error.message);
                }
            }
            
            if (!serverFound) {
                result.innerHTML = `
                    <div class="error">
                        ‚ùå <strong>Aucun serveur trouv√©</strong><br>
                        Ports test√©s: ${ports.join(', ')}<br><br>
                        <strong>Action requise:</strong><br>
                        1. Ouvrez un terminal<br>
                        2. Naviguez vers le dossier client<br>
                        3. Ex√©cutez: <code>npm run dev</code>
                    </div>
                `;
            }
        }
        
        async function checkAPIs() {
            const result = document.getElementById('result');
            result.innerHTML = '<div class="info">‚è≥ Test des APIs...</div>';
            
            const apis = [
                '/api/users',
                '/api/missions',
                '/api/debug-freelances',
                '/api/missions-debug'
            ];
            
            let results = [];
            
            for (const api of apis) {
                try {
                    const response = await fetch(api);
                    const status = response.status;
                    results.push(`‚úÖ ${api}: ${status}`);
                } catch (error) {
                    results.push(`‚ùå ${api}: ${error.message}`);
                }
            }
            
            result.innerHTML = `
                <div class="info">
                    <h4>üìä R√©sultats des tests API:</h4>
                    ${results.map(r => `<p>${r}</p>`).join('')}
                </div>
            `;
        }
        
        // Test automatique au chargement
        window.onload = function() {
            setTimeout(checkServer, 1000);
        };
    </script>
</body>
</html>
